CompAZ

Parametrization of the Compton spectra for gamma-gamma collider at TESLA 
Prepared by A.F.Zarnecki 

First version, Nov. 21, 2001 
Updated, March 26, 2001 


Introduction
============

The study is based on the gamma-gamma luminosity spectra generated by 
Valery Telnov in October 2001 (for 100, 250 and 400 GeV electron beam.
As expected, the high energy part of the spectra can be described
by the convolution of two independent photon energy distributions.
It turned out that such a convolution gives also a resonable
description for  collisions, where only one gamma has large energy
(close to the maximum energy available in the Compton scattering)
and the other one is softer (with energy down to about a quater of
the maximum photon energy). However, photon energy spectra in this 
range is not described by simple Compton formula.

Parametrization
===============

CompAZ parametrization is based on the ideas presented in the paper 
by I.F.Ginzburg and G.L.Kotkin (hep-ph/9905462, Eur.Phys.J.C13,295-300,2000).
The photon energy spectra is assumed to consists of three components:

    * "single" Compton scattering   as described by Ginzburg & Kotkin
   with 'z' parameter corrected for non-linear effects (z=4*E_e*E_l/m_e^2)

    * scattering involving 2 photons, which corresponds to doubling 'z' 
  parameter (this process produces high energy "step", extending above x_max)

    * scattering on secondary (already scattered once) electrons
   this contribution is calculated by numerical convolution of two Compton
   spectra (for primary and secondary scattering)

Fit
===

The parametrization was fitted simultaneously to photon energy spectra
for 100, 250 and 400 GeV electron beam energy. Uncorrelated part of
the spectra was chosen by the requirement that the other photon has
high energy (greater than 0.4, 0.6 and 0.65 of electron beam energy 
respectively). With only 10(!) free parameters (including normalization) 
a very good description of the energy spectra down to x_gamma of about 
0.1 is obtained for all energies. The parametrization also gives
resonable description of the beam polarisation, with only two additional
assumptions (and no additional parameters): scattering involving 2 photons
results in high polarisation weakly depending on energy; secondary
electrons are unpolarized.

Normalization
=============

Normalization is defined by the requirement that the two photon
distribution at high x (x=E_gamma/E_e)

                p(x_1,x_2) = f(x_1) * f(x_2)

describes the spectra generated by V.Telnov

                p(x_1,x_2) = 1/N * dN/dx_1/dx_2

As low x part of the spectra (x< ~0.1) is not properly described and 
underestimated, the normalization of the single photon distribution varies 
from about 0.8 at 50 GeV to about 0.55 at 500 GeV. This means that the two 
photon spectra obtained from the convolution of the two distributions
describes between 65 and 30% of all events (but all high x events).
When calculating numbers of expected events product of the two single
photon spectra should be multiplied by the total gamma-gamma luminosity.

If needed, normalization of the spectra can be obtained from call to 
event generating routine CompAZGN (see last section below).


Validity
========

Energy dependence was fitted using spectra at 100, 250 and 400 GeV.
In most cases parameter were found to depend linearly on energy.
Parametrisation should work properly for electron beam energy:

                  50 <= Ee <= 500 GeV

To avoid possible problems (also numerical) the routine returns 
values of 0 outside this energy range (warning message is also printed).

Proper description of the spectra is obtained for

               W   > ~0.3*W_max 

where  W_max  = 2*E_e*x_max and x_max = z/(z+1)  is the maximum energy 
fraction for photon produced in "single Compton" scattering

This means that the energy spectrum for the photon is resonably 
described for

                x > 0.15 * x_max

assuming that the other photon is in the high energy peak 

                x_2 > 0.6 * x_max



Routine
=======

Fortran function 'compaz.f':

       Real Function Compaz(x,E,icase)


 Input parameters:
 -----------------

     x (Real)        Fraction of beam energy carried by photon  ( 0 < x < 1 )

     E (Real)        Electron beam energy [GeV]  ( 50 < E < 500 )

     Icase (Integer) Choice of output distribution:

     Icase = 0       Full spectra - sum of three contributions
             1       Main contribution from direct Compton process
             2       Contribution from scattering with 2 photons
             3       Contribution from scattering on secondary electrons

            10       Polarisation of the full spectra
            11       Polarisation of the 1st component (direct Compton)
            12       Polarisation of the 2nd component (two photon)
            13       Polarisation of the 3rd component (secondary electron)

            20       Effective z parameter
            21       maximum x value for direct Compton
            22       maximum x value for scattering with 2 photons



 Output value:
 -------------

   Value of the selected energy distribution (icase=0...3), 
   polarization (icase=10...13) or parameter (icase=20...22)

   Zero value (for both density and polarization) is returned for
   x < 0 or x > x_max2 (maximum x for scattering with 2 photons)

   For wrong 'icase', too small or too large 'E' wwaring message is printed
   and zero value is returned.



Two internal functions are also included:

    *  Real Function Compazc(x,z,Pol)
       Real x,z,Pol

         Calculating 'ideal' spectrum of compton backscattered photons
   
    *  Real Function Compazp(x,Pl,Pb,z)
       Real x,Pl,Pb,z

         Calculating polarization of the compton spectra


Event Generation
================

    Single photon spectra
    =====================

As CompAZ routine itself is quite time consuming (involves numerical
integration), dedicated routine 'compazgn.f' was prepared for very
fast photon energy generation:

      Subroutine CompAZGN(Ein,Eg,Pg)


  Input:  
  ------
     Ein (Real)  - electron beam energy [GeV]  50.<=Abs(Ein)<=500.

  Output: 
  -------
     Eg (Real)   - generated photon energy
     Pg (Real)   - photon polarization for this energy


  At first call (or when input beam energy changes) an array of
  probabilities (N=1000) is calculated from CompAZ. Variable bin size
  is used to describe details of the distribution properly.
  Links between bins with low and high probabilities are set to
  speed up generation.  

  Generation itself is very fast. To select the energy bin and
  to smear energy value inside the bin 3 uniform distributed random
  numbers are generated per event (using CERNLIB routine RANMAR).


  Normalization:
  --------------
  when called with  Ein<0, routine returns normalization of CompAZ spectra 
  for E=ABS(Ein) as Eg (Pg is not used).


  Gamma-Gamma events
  ==================

Assuming that photon energies are independent (which is true for large W)
CompAZGN routine can be also used to generate gamma-gamma events.
However, this method is not very effective when studing narrow resonance 
production (e.g. Higgs). Therefor, dedicated routine has been prepared for
fast event generation:

      Subroutine CompAZG2(Ein,Wmin,Wmax,E1,P1,E2,P2)

  Input:  
  ------
             Ein   - electron beam energy [GeV]  50.<=Abs(Ein)<=500.
             Wmin  - minimum value of W_gg
             Wmax  - maximum value og W_gg
                     if Wmax<=0 -> up to the limit
  Output: 
  -------
             E1,E2  - generated photon energies
             P1,P2  - corresponding photon polarizations

  Method:
  -------

  Depending on the W range given, routine chooses one of the following
  algorithms:

        * for Wmin=Wmax  => one dimensional method
          rapidity y of the gamma-gamma system is generated 
  
        * for Wmin<Wmax and narrow W window 
 (the corresponding fraction of the available kinematic space less than 0.1)
   => two-dimensional generation in (W,y) space

        * for Wmin<Wmax and wide W window 
 (the corresponding fraction of the available kinematic space above 0.1)
   => generates two independent photons using CompAZGN


  Normalization:
  --------------
  when called with  Ein<0, routine returns normalization of 2-D spectra 
  (in selected W range) for E=ABS(Ein). Normalization is stored in E1:

             E1 =  1/L * \int\limits_{Wmin}^{Wmax} dL/dW  ,  

  E2,P1 and P2 are not used (set to 0). For narrow W range (generation 
  in W-y space) normalization is calculated by numerical integration 
  and ia available already at the first call. However, if wide W range is
  selected, and generation is based on CompAZGN (see above), normalization
  is calculated from the fraction of accepted events and should be checked
  only after the generation is finished (!).

  If Wmin=Wmax, returned value is

                   E1 =  1/L * dL/dW  [1/GeV]


Invariant mass spectra 
======================

  Invariant mass distribution of colliding photons can be calculated
with function CompazW:

      real function compazw(W,E,ic)

  Input:  
  ------
      E (Real)     - electron beam energy [GeV]  50.<=Abs(Ein)<=500.
      W (Real)     - photon-photon center of mass energy
      Ic (Integer) - choice of output distribution:

         Ic = 0       full spectra - sum of J=0 and J=2
              1       J=0 spectra only
              2       J=2 spectra only


   Output value:
   -------------
        Two photon invariant mass distribution, relative to the
   integrated photon-photon luminosity:

            compazw(W,...) =  1/L *  dL/dW [1/GeV]
                             

Integral of CompazW corresponds to the normalization of CompAZ spectra
(see comments above). 
   

     
        
